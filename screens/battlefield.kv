<BattleField>:
    playing_area: playing_area
    enemy_grid: enemy_grid
    player_grid: player_grid

    AnchorLayout:
        MDBoxLayout:
            id: playing_area
            MDBoxLayout:
                orientation: "vertical"

                EnemyGrid:
                    id: enemy_grid
                    is_enemy_grid: True
                    allowed_ships: root.allowed_ships
                    md_bg_color: app.theme_cls.primary_color
                    on_blocked:
                        whos_turn.text = "Enemy's Turn" if self.blocked else "Player's Turn"
                        if self.blocked: root.enemy_turn()

                PlayerGrid:
                    id: player_grid
                    allowed_ships: root.allowed_ships

            MDBoxLayout:
                orientation: "vertical"

                MDLabel:
                    id: whos_turn

                MDLabel:
                    id: remaining_ships

        BoxLayout:
            id: menu_overlay
            orientation: 'vertical'
            size_hint_y: 0 if root.has_won is None else 1
            opacity: 0 if root.has_won is None else 1

            ShadowLabel:
                text_size: self.width, self.height
                valign: 'middle'
                halign: 'center'
                bold: True
                font_size: "50sp"
                decal: 2, -2
                tint: .5, .5, 1, .5
                color: 1, 0, 0, .9
                text: "You have won!" if root.has_won else "You have lost"

            AnchorLayout:
                BoxLayout:
                    orientation: 'vertical'
                    size_hint: 0.6, 0.4
                    spacing: "10dp"

                    RoundButton:
                        text: "Play again"
                        on_press: app.root.current = 'prepare'

                    RoundButton:
                        text: "Back to Menu"
                        on_press: app.root.current = 'main'
