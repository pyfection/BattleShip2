<BattleField>:
    playing_area: playing_area
    enemy_grid: enemy_grid
    player_grid: player_grid

    AnchorLayout:
        MDBoxLayout:
            id: playing_area
            orientation: "vertical"
            on_size:
                s = min([self.width, self.height*.5])
                enemy_grid.size = (s, s)
                player_grid.size = (s, s)

            EnemyGrid:
                id: enemy_grid
                is_enemy_grid: True
                allowed_ships: root.allowed_ships
                md_bg_color: app.theme_cls.primary_color
                on_blocked:
                    if self.blocked: root.enemy_turn()

            Widget:
                size_hint: 1, None
                height: 4
                canvas:
                    Color:
                        rgb: 0, 0, 0
                    Rectangle:
                        pos: self.pos
                        size: self.size

            PlayerGrid:
                id: player_grid
                allowed_ships: root.allowed_ships

        MDBoxLayout:
            id: menu_overlay
            orientation: 'vertical'
            size_hint_y: 0 if root.has_won is None else 1
            opacity: 0 if root.has_won is None else 1
            md_bg_color: (0, 0, 0, .8)

            ShadowLabel:
                text_size: self.width, self.height
                valign: 'middle'
                halign: 'center'
                bold: True
                font_size: "50sp"
                decal: 2, -2
                tint: .5, .5, 1, .5
                color: 1, 0, 0, .9
                text: "You have won!" if root.has_won else "You have lost"

            AnchorLayout:
                MDBoxLayout:
                    orientation: 'vertical'
                    size_hint: 0.6, 0.4
                    spacing: "10dp"

                    RoundButton:
                        text: "Play again"
                        on_press: app.root.current = 'prepare'

                    RoundButton:
                        text: "Back to Menu"
                        on_press: app.root.current = 'main'
